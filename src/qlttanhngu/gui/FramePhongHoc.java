/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package qlttanhngu.gui;

import Assest.StoreSave;
import java.util.logging.Level;
import java.util.logging.Logger;
import qlttanhngu.controller.ChuongTrinhHocController;
import qlttanhngu.controller.PhongHocController;
import qlttanhngu.dto.PhongHocDTO;

/**
 *
 * @author MinhVu020
 */
public class FramePhongHoc extends javax.swing.JInternalFrame {

    /**
     * Creates new form FramePhongHoc
     */
    public FramePhongHoc() {
        initComponents();
        this.txtSoLuong.setDocument(new DigitsDocument());
        this.btnSua.setEnabled(false);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        PanelThongTinPhongHoc = new javax.swing.JPanel();
        lblTenPhong = new javax.swing.JLabel();
        txtTenPhong = new javax.swing.JTextField();
        lblSoLuong = new javax.swing.JLabel();
        txtSoLuong = new javax.swing.JTextField();
        lblDiaChi = new javax.swing.JLabel();
        txtDiaChi = new javax.swing.JTextField();
        PanelTinhNang = new javax.swing.JPanel();
        btnThemPhongHoc = new javax.swing.JButton();
        btnThoat = new javax.swing.JButton();
        btnSua = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        TablePhongHoc = new javax.swing.JTable();

        addInternalFrameListener(new javax.swing.event.InternalFrameListener() {
            public void internalFrameDeiconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameActivated(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameIconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameDeactivated(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameClosed(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameOpened(javax.swing.event.InternalFrameEvent evt) {
                formInternalFrameOpened(evt);
            }
            public void internalFrameClosing(javax.swing.event.InternalFrameEvent evt) {
            }
        });

        PanelThongTinPhongHoc.setBorder(javax.swing.BorderFactory.createTitledBorder("Thông Tin Phòng Học"));

        lblTenPhong.setText("Tên Phòng");

        lblSoLuong.setText("Số Lượng");

        lblDiaChi.setText("Địa Chỉ");

        javax.swing.GroupLayout PanelThongTinPhongHocLayout = new javax.swing.GroupLayout(PanelThongTinPhongHoc);
        PanelThongTinPhongHoc.setLayout(PanelThongTinPhongHocLayout);
        PanelThongTinPhongHocLayout.setHorizontalGroup(
            PanelThongTinPhongHocLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelThongTinPhongHocLayout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addGroup(PanelThongTinPhongHocLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblTenPhong)
                    .addComponent(lblSoLuong, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(lblDiaChi, javax.swing.GroupLayout.Alignment.TRAILING))
                .addGap(27, 27, 27)
                .addGroup(PanelThongTinPhongHocLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txtTenPhong)
                    .addComponent(txtSoLuong)
                    .addComponent(txtDiaChi, javax.swing.GroupLayout.DEFAULT_SIZE, 242, Short.MAX_VALUE))
                .addContainerGap(87, Short.MAX_VALUE))
        );
        PanelThongTinPhongHocLayout.setVerticalGroup(
            PanelThongTinPhongHocLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelThongTinPhongHocLayout.createSequentialGroup()
                .addGap(18, 18, 18)
                .addGroup(PanelThongTinPhongHocLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblTenPhong)
                    .addComponent(txtTenPhong, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(PanelThongTinPhongHocLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblSoLuong)
                    .addComponent(txtSoLuong, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(PanelThongTinPhongHocLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtDiaChi, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblDiaChi))
                .addContainerGap(52, Short.MAX_VALUE))
        );

        PanelTinhNang.setBorder(javax.swing.BorderFactory.createTitledBorder("Tính Năng"));

        btnThemPhongHoc.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Resources/Buttonadd.png"))); // NOI18N
        btnThemPhongHoc.setText("Thêm Phòng");
        btnThemPhongHoc.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThemPhongHocActionPerformed(evt);
            }
        });

        btnThoat.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Resources/Close1.png"))); // NOI18N
        btnThoat.setText("Thoát");
        btnThoat.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThoatActionPerformed(evt);
            }
        });

        btnSua.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Resources/rules.png"))); // NOI18N
        btnSua.setText("Sửa Thông Tin");
        btnSua.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSuaActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout PanelTinhNangLayout = new javax.swing.GroupLayout(PanelTinhNang);
        PanelTinhNang.setLayout(PanelTinhNangLayout);
        PanelTinhNangLayout.setHorizontalGroup(
            PanelTinhNangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelTinhNangLayout.createSequentialGroup()
                .addGap(47, 47, 47)
                .addComponent(btnThemPhongHoc)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 51, Short.MAX_VALUE)
                .addComponent(btnSua)
                .addGap(43, 43, 43)
                .addComponent(btnThoat, javax.swing.GroupLayout.PREFERRED_SIZE, 137, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(53, 53, 53))
        );
        PanelTinhNangLayout.setVerticalGroup(
            PanelTinhNangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelTinhNangLayout.createSequentialGroup()
                .addGap(62, 62, 62)
                .addGroup(PanelTinhNangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnThemPhongHoc, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnThoat, javax.swing.GroupLayout.PREFERRED_SIZE, 43, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnSua))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        TablePhongHoc.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Mã Phòng", "Tên Phòng", "Số Lượng", "Địa Chỉ"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        TablePhongHoc.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                TablePhongHocMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(TablePhongHoc);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jScrollPane1)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(PanelThongTinPhongHoc, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGap(18, 18, 18)
                        .addComponent(PanelTinhNang, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(23, 23, 23)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(PanelThongTinPhongHoc, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(PanelTinhNang, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(18, 18, 18)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 276, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(205, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void btnThoatActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThoatActionPerformed
        // TODO add your handling code here:
        this.dispose();
        
    }//GEN-LAST:event_btnThoatActionPerformed

    private void btnSuaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSuaActionPerformed

        PhongHocController control = null;
        int numSelect = this.TablePhongHoc.getSelectedRowCount();
        if (numSelect < 1) {
            MessageBoxCustom messageBoxHocVien = new MessageBoxCustom("Chưa Chọn Phòng Học!");
            StoreSave.desktop.add(messageBoxHocVien);
            messageBoxHocVien.setBounds(400, 100, 511, 189);
            messageBoxHocVien.show();
        } else {
            int select = this.TablePhongHoc.getSelectedRow();
            Object maPhong = this.TablePhongHoc.getValueAt(select, 0);
            String tenPhong = this.txtTenPhong.getText();
            int soluong = Integer.parseInt(this.txtSoLuong.getText());
            String diaChi = this.txtDiaChi.getText();
            try {
                control = new PhongHocController();
                
            } catch (Exception ex) {
                Logger.getLogger(FramePhongHoc.class.getName()).log(Level.SEVERE, null, ex);
            }
            
            //update
             if (control.UpdatePhongHoc(maPhong.toString(), tenPhong, soluong,diaChi )) {
                MessageBoxCustom messageBoxHocVien = new MessageBoxCustom("Update Thành Công!");
                StoreSave.desktop.add(messageBoxHocVien);
                messageBoxHocVien.setBounds(400, 100, 511, 189);
                messageBoxHocVien.show();
                //show bang
                  try {
                    
                    this.TablePhongHoc.setModel(new PhongHocController().GetPhongHoc());
                } catch (Exception ex) {
                    Logger.getLogger(FramePhongHoc.class.getName()).log(Level.SEVERE, null, ex);
                }
                
            } else {
                MessageBoxCustom messageBoxHocVien = new MessageBoxCustom("Update Thất Bại!");
                StoreSave.desktop.add(messageBoxHocVien);
                messageBoxHocVien.setBounds(400, 100, 511, 189);
                messageBoxHocVien.show();
            }

        }
    }//GEN-LAST:event_btnSuaActionPerformed

    private void btnThemPhongHocActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThemPhongHocActionPerformed

        PhongHocController control = null;
        if (this.txtDiaChi.getText().contentEquals("") == false && this.txtSoLuong.getText().contentEquals("") == false
                && this.txtTenPhong.getText().contentEquals("") == false) {
            int soLuong = Integer.parseInt(this.txtSoLuong.getText());
            String diaChi = this.txtDiaChi.getText();
            String tenPhong = this.txtTenPhong.getText();
            try {
                //Them chuong trinh moi---kiem tra dieu kien
                control = new PhongHocController();
            } catch (Exception ex) {
                Logger.getLogger(FramePhongHoc.class.getName()).log(Level.SEVERE, null, ex);
            }
            
            PhongHocDTO phdto = new PhongHocDTO();
            phdto.setDiaChi(diaChi);
            phdto.setSoLuong(soLuong);
            phdto.setTenPhong(tenPhong);
            
            //them phong hoc
             if (control.AddPhongHoc(phdto)) {
                //them thanh cong
                MessageBoxCustom messageBoxHocVien = new MessageBoxCustom("Thêm Thành Công!");
                StoreSave.desktop.add(messageBoxHocVien);
                messageBoxHocVien.setBounds(400, 100, 511, 189);
                messageBoxHocVien.show();
                
                //show danh sach phong
                try {
                    
                    this.TablePhongHoc.setModel(new PhongHocController().GetPhongHoc());
                } catch (Exception ex) {
                    Logger.getLogger(FramePhongHoc.class.getName()).log(Level.SEVERE, null, ex);
                }

            } else {
                //khong them dc
                MessageBoxCustom messageBoxHocVien = new MessageBoxCustom("Thêm Thất Bại!");
                StoreSave.desktop.add(messageBoxHocVien);
                messageBoxHocVien.setBounds(400, 100, 511, 189);
                messageBoxHocVien.show();
            }
            



        } else {
            MessageBoxCustom messageBoxHocVien = new MessageBoxCustom("Chưa Nhập Đủ Thông Tin!");
            StoreSave.desktop.add(messageBoxHocVien);
            messageBoxHocVien.setBounds(400, 100, 511, 189);
            messageBoxHocVien.show();
        }

    }//GEN-LAST:event_btnThemPhongHocActionPerformed

    private void TablePhongHocMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_TablePhongHocMouseClicked

        //Khi bang Click
        int select = this.TablePhongHoc.getSelectedRow();
        
        Object tenPhong = this.TablePhongHoc.getValueAt(select, 1);
        Object soLuong = this.TablePhongHoc.getValueAt(select, 2);
        Object diaChi = this.TablePhongHoc.getValueAt(select, 3);
        //set cho txt
        this.txtDiaChi.setText(diaChi.toString());
        this.txtSoLuong.setText(soLuong.toString());
        this.txtTenPhong.setText(tenPhong.toString());
        
         this.btnSua.setEnabled(true);

    }//GEN-LAST:event_TablePhongHocMouseClicked

    private void formInternalFrameOpened(javax.swing.event.InternalFrameEvent evt) {//GEN-FIRST:event_formInternalFrameOpened
       
        try {      
                    this.TablePhongHoc.setModel(new PhongHocController().GetPhongHoc());
                } catch (Exception ex) {
                    Logger.getLogger(FramePhongHoc.class.getName()).log(Level.SEVERE, null, ex);
                }
    }//GEN-LAST:event_formInternalFrameOpened

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel PanelThongTinPhongHoc;
    private javax.swing.JPanel PanelTinhNang;
    private javax.swing.JTable TablePhongHoc;
    private javax.swing.JButton btnSua;
    private javax.swing.JButton btnThemPhongHoc;
    private javax.swing.JButton btnThoat;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JLabel lblDiaChi;
    private javax.swing.JLabel lblSoLuong;
    private javax.swing.JLabel lblTenPhong;
    private javax.swing.JTextField txtDiaChi;
    private javax.swing.JTextField txtSoLuong;
    private javax.swing.JTextField txtTenPhong;
    // End of variables declaration//GEN-END:variables
}
