/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package qlttanhngu.gui;

import Assest.StoreSave;
import java.beans.PropertyVetoException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Vector;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.DefaultComboBoxModel;
import javax.swing.JInternalFrame;
import javax.swing.JOptionPane;
import javax.swing.JTable;
import javax.swing.table.DefaultTableModel;
import qlttanhngu.controller.HocVienController;
import qlttanhngu.controller.LopHocController;
import qlttanhngu.dto.DanhSachThiDTO;
import qlttanhngu.dto.LopHocDTO;

/**
 *
 * @author XUANVINHTD
 */
public class FrameXepLop extends javax.swing.JInternalFrame {

    /**
     * Creates new form FrameXepLop
     */
    public FrameXepLop() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        panelXepLop = new javax.swing.JPanel();
        lblMaLop = new javax.swing.JLabel();
        lblTenLop = new javax.swing.JLabel();
        lblGiangVien = new javax.swing.JLabel();
        lblChuongTrinhHoc = new javax.swing.JLabel();
        txtGiangVien = new javax.swing.JTextField();
        txtChuongTrinhHoc = new javax.swing.JTextField();
        lblKhoaHoc = new javax.swing.JLabel();
        lblDiemDauVao = new javax.swing.JLabel();
        lblPhong = new javax.swing.JLabel();
        txtKhoaHoc = new javax.swing.JTextField();
        txtDiemDauVao = new javax.swing.JTextField();
        txtPhong = new javax.swing.JTextField();
        panelChucNang = new javax.swing.JPanel();
        btnThem = new javax.swing.JButton();
        btnChTiet = new javax.swing.JButton();
        btnDong = new javax.swing.JButton();
        btnLuu = new javax.swing.JButton();
        btnXepLop = new javax.swing.JButton();
        comboBoxMaLop = new javax.swing.JComboBox();
        txtTenLop = new javax.swing.JTextField();
        txtSoLuong = new javax.swing.JTextField();
        lblSoLuong = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        tableDanhSachHocVien = new javax.swing.JTable();
        jScrollPane2 = new javax.swing.JScrollPane();
        tableDanhSachHocVienDaChon = new javax.swing.JTable();
        btnChonTatCa = new javax.swing.JButton();
        btnChonDon = new javax.swing.JButton();
        btnXoaTatCa = new javax.swing.JButton();
        btnXoaDon = new javax.swing.JButton();

        setTitle("Xếp Lớp");
        addInternalFrameListener(new javax.swing.event.InternalFrameListener() {
            public void internalFrameActivated(javax.swing.event.InternalFrameEvent evt) {
                formInternalFrameActivated(evt);
            }
            public void internalFrameClosed(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameClosing(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameDeactivated(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameDeiconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameIconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameOpened(javax.swing.event.InternalFrameEvent evt) {
            }
        });

        panelXepLop.setBorder(javax.swing.BorderFactory.createTitledBorder("Thông Tin"));

        lblMaLop.setText("Mã Lớp");

        lblTenLop.setText("Tên Lớp");

        lblGiangVien.setText("Giảng Viên");

        lblChuongTrinhHoc.setText("Tên Chương Trình Học");

        txtGiangVien.setEnabled(false);

        txtChuongTrinhHoc.setEnabled(false);

        lblKhoaHoc.setText("Tên Khóa Học");

        lblDiemDauVao.setText("Điểm Thi Đầu Vào Yêu Cầu");

        lblPhong.setText("Phòng");

        txtKhoaHoc.setEnabled(false);

        txtPhong.setEnabled(false);

        panelChucNang.setBorder(javax.swing.BorderFactory.createTitledBorder("Chức Năng"));

        btnThem.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Resources/Buttonadd.png"))); // NOI18N
        btnThem.setText("Thêm");
        btnThem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThemActionPerformed(evt);
            }
        });

        btnChTiet.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Resources/ChiTiet.png"))); // NOI18N
        btnChTiet.setText("Chi Tiết ");
        btnChTiet.setToolTipText("Cho Biết Danh Sách Các Học Viên Trong Từng Lớp");
        btnChTiet.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnChTietActionPerformed(evt);
            }
        });

        btnDong.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Resources/Close1.png"))); // NOI18N
        btnDong.setText("Dóng");
        btnDong.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnDongActionPerformed(evt);
            }
        });

        btnLuu.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Resources/save.png"))); // NOI18N
        btnLuu.setText("Lưu");
        btnLuu.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLuuActionPerformed(evt);
            }
        });

        btnXepLop.setText("Xếp lớp thi thử");
        btnXepLop.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnXepLopActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout panelChucNangLayout = new javax.swing.GroupLayout(panelChucNang);
        panelChucNang.setLayout(panelChucNangLayout);
        panelChucNangLayout.setHorizontalGroup(
            panelChucNangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelChucNangLayout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addComponent(btnXepLop)
                .addGap(18, 18, 18)
                .addComponent(btnThem, javax.swing.GroupLayout.PREFERRED_SIZE, 106, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(btnLuu, javax.swing.GroupLayout.PREFERRED_SIZE, 104, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(btnChTiet, javax.swing.GroupLayout.PREFERRED_SIZE, 124, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(btnDong, javax.swing.GroupLayout.PREFERRED_SIZE, 101, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        panelChucNangLayout.setVerticalGroup(
            panelChucNangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelChucNangLayout.createSequentialGroup()
                .addGap(32, 32, 32)
                .addGroup(panelChucNangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnThem)
                    .addComponent(btnChTiet)
                    .addComponent(btnDong)
                    .addComponent(btnLuu)
                    .addComponent(btnXepLop, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(29, Short.MAX_VALUE))
        );

        comboBoxMaLop.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                comboBoxMaLopItemStateChanged(evt);
            }
        });

        txtTenLop.setEnabled(false);

        txtSoLuong.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtSoLuongActionPerformed(evt);
            }
        });

        lblSoLuong.setText("Số lượng");

        javax.swing.GroupLayout panelXepLopLayout = new javax.swing.GroupLayout(panelXepLop);
        panelXepLop.setLayout(panelXepLopLayout);
        panelXepLopLayout.setHorizontalGroup(
            panelXepLopLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, panelXepLopLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(panelXepLopLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(lblTenLop)
                    .addComponent(lblMaLop)
                    .addComponent(lblDiemDauVao)
                    .addComponent(lblSoLuong))
                .addGap(30, 30, 30)
                .addGroup(panelXepLopLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(txtSoLuong, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtDiemDauVao, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(comboBoxMaLop, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtTenLop, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(panelXepLopLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblKhoaHoc, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(lblPhong, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(lblGiangVien, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(lblChuongTrinhHoc, javax.swing.GroupLayout.Alignment.TRAILING))
                .addGap(18, 18, 18)
                .addGroup(panelXepLopLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txtGiangVien, javax.swing.GroupLayout.DEFAULT_SIZE, 221, Short.MAX_VALUE)
                    .addComponent(txtKhoaHoc)
                    .addComponent(txtPhong)
                    .addComponent(txtChuongTrinhHoc))
                .addGap(18, 18, 18)
                .addComponent(panelChucNang, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        panelXepLopLayout.setVerticalGroup(
            panelXepLopLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelXepLopLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(panelXepLopLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(panelXepLopLayout.createSequentialGroup()
                        .addGroup(panelXepLopLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(lblMaLop)
                            .addComponent(lblKhoaHoc)
                            .addComponent(txtKhoaHoc, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(comboBoxMaLop, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(panelXepLopLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(lblTenLop)
                            .addComponent(txtPhong, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(lblPhong)
                            .addComponent(txtTenLop, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(panelXepLopLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(lblGiangVien)
                            .addComponent(txtGiangVien, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txtDiemDauVao, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(lblDiemDauVao))
                        .addGap(25, 25, 25)
                        .addGroup(panelXepLopLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(lblChuongTrinhHoc)
                            .addComponent(txtChuongTrinhHoc, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txtSoLuong, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(lblSoLuong)))
                    .addComponent(panelChucNang, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(0, 18, Short.MAX_VALUE))
        );

        tableDanhSachHocVien.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        tableDanhSachHocVien.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tableDanhSachHocVienMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(tableDanhSachHocVien);

        tableDanhSachHocVienDaChon.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        tableDanhSachHocVienDaChon.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tableDanhSachHocVienDaChonMouseClicked(evt);
            }
        });
        jScrollPane2.setViewportView(tableDanhSachHocVienDaChon);

        btnChonTatCa.setText(">>");
        btnChonTatCa.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnChonTatCaActionPerformed(evt);
            }
        });

        btnChonDon.setText(">");
        btnChonDon.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnChonDonActionPerformed(evt);
            }
        });

        btnXoaTatCa.setText("<<");
        btnXoaTatCa.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnXoaTatCaActionPerformed(evt);
            }
        });

        btnXoaDon.setText("<");
        btnXoaDon.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnXoaDonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 619, Short.MAX_VALUE)
                .addGap(51, 51, 51)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(btnChonTatCa, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnChonDon, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnXoaTatCa, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnXoaDon, javax.swing.GroupLayout.PREFERRED_SIZE, 83, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(64, 64, 64)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 672, Short.MAX_VALUE)
                .addContainerGap())
            .addComponent(panelXepLop, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(panelXepLop, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 443, Short.MAX_VALUE)
                    .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(btnChonTatCa)
                        .addGap(18, 18, 18)
                        .addComponent(btnChonDon)
                        .addGap(27, 27, 27)
                        .addComponent(btnXoaTatCa)
                        .addGap(18, 18, 18)
                        .addComponent(btnXoaDon)
                        .addGap(0, 276, Short.MAX_VALUE)))
                .addContainerGap())
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void btnChTietActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnChTietActionPerformed
         if(frameChiTietXepLop == null || frameChiTietXepLop.isClosed())
         {
           InitFrameInternal(new FrameChiTietXepLop());
         } 
    }//GEN-LAST:event_btnChTietActionPerformed

    private void formInternalFrameActivated(javax.swing.event.InternalFrameEvent evt) {//GEN-FIRST:event_formInternalFrameActivated
        try {
                 hashMapTenLop = new LopHocController().GetListLopHoc();
                 DefaultComboBoxModel defaultComboBoxModel = new DefaultComboBoxModel(hashMapTenLop.keySet().toArray());
                //set model cho comboBoxMaLop
                 comboBoxMaLop.setModel(defaultComboBoxModel);
        } catch (Exception ex) {
            Logger.getLogger(FrameXepLop.class.getName()).log(Level.SEVERE, null, ex);
        }

    }//GEN-LAST:event_formInternalFrameActivated

    private void comboBoxMaLopItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_comboBoxMaLopItemStateChanged
        
        try {
            List<LopHocDTO> listlh = new ArrayList<LopHocDTO>();
            listlh = new LopHocController().LoadListLopHocTheoMaLop(this.comboBoxMaLop.getSelectedItem().toString());
            txtTenLop.setText(new LopHocController().GetListLopHoc().get(listlh.get(0).getMaLop()));
//            comboBoxTenLop.setSelectedItem(new LopHocController().GetListLopHoc().get(listlh.get(0).getMaLop()));
            txtChuongTrinhHoc.setText(new LopHocController().GetListChuongTrinhHoc().get(listlh.get(0).getMaChuongTrinhHoc()));
            txtGiangVien.setText(new LopHocController().GetListGiangVien().get(listlh.get(0).getMaNhanVien()));
            txtPhong.setText(new LopHocController().GetListPhongHoc().get(listlh.get(0).getMaPhong()));
            txtKhoaHoc.setText(new LopHocController().GetListKhoaHoc().get(listlh.get(0).getMaKhoaHoc()));
            
        } catch (Exception ex) {
            Logger.getLogger(FrameXepLop.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_comboBoxMaLopItemStateChanged

    private void btnChonTatCaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnChonTatCaActionPerformed
        // lấy tất cả học viên qua danh sách phòng
        int soluong = Integer.parseInt(txtSoLuong.getText());
        //không có dữ liệu thì ko dc add
        if (tableDanhSachHocVien.getRowCount() == 0 || soluong == tableDanhSachHocVienDaChon.getRowCount()) {
            return;
        }
        for (int i = 0; i < soluong; i++) {
            if (tableDanhSachHocVien.getRowCount() == 0) {
                return;
            }
            maHocVien = tableDanhSachHocVien.getValueAt(0, 0).toString();
            tenHocVien = tableDanhSachHocVien.getValueAt(0, 1).toString();
            ketQuaThi = Double.parseDouble(tableDanhSachHocVien.getValueAt(0,2).toString());
            rowIndexDSHV = 0;
            this.btnChonDonActionPerformed(evt);
        }
    }//GEN-LAST:event_btnChonTatCaActionPerformed

    private void btnChonDonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnChonDonActionPerformed
        DefaultTableModel defaultTableModel = (DefaultTableModel) tableDanhSachHocVienDaChon.getModel();

        //kiểm tra số lượng trong phòng
        int soluong = Integer.parseInt(txtSoLuong.getText());
        if(soluong == tableDanhSachHocVienDaChon.getRowCount()){
            JOptionPane.showMessageDialog(this, "Phòng đã đầy! !");
            return;
        }
        //kiểm tra xem đã chọn dòng chưa.
        if (maHocVien == null) {
            JOptionPane.showMessageDialog(this, "Vui lòng chọn học viên trước khi thêm !");
            return;
        }
        //kiểm tra xem học viên  đã được add chưa
        if (tableDanhSachHocVienDaChon.getRowCount() != 0) {
            for (int i = 0; i < tableDanhSachHocVienDaChon.getRowCount(); i++) {
                if (tableDanhSachHocVienDaChon.getValueAt(i, 0).toString().equals(maHocVien)) {
                    JOptionPane.showMessageDialog(this, "Học vên này đã tồn tại !");
                    return;
                }
            }
        }
        
        //add thêm học viên vào table phòng thi
        Vector row = new Vector();
        row.add(maHocVien);
        row.add(tenHocVien);
        row.add(ketQuaThi);
        defaultTableModel.addRow(row);
        //xóa dòng bên danh sách học viên
        if (tableDanhSachHocVien.getRowCount() >= rowIndexDSHV) {
            ((DefaultTableModel) tableDanhSachHocVien.getModel()).removeRow(rowIndexDSHV);
        }
        maHocVien = null;
        tenHocVien = null;
        ketQuaThi = null;
    }//GEN-LAST:event_btnChonDonActionPerformed

    private void btnXoaTatCaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnXoaTatCaActionPerformed
        // lấy tất cả học viên qua danh sách phòng
        int soluong = Integer.parseInt(txtSoLuong.getText());
        int soluongphong = tableDanhSachHocVienDaChon.getRowCount();
        //không có dữ liệu thì ko dc add
        if (tableDanhSachHocVienDaChon.getRowCount() == 0) {
            return;
        }
        for (int i = 0; i < (soluong); i++) {
            if (tableDanhSachHocVienDaChon.getRowCount() == 0) {
                return;
            }
            maHocVien = tableDanhSachHocVienDaChon.getValueAt(0, 0).toString();
            tenHocVien = tableDanhSachHocVienDaChon.getValueAt(0, 1).toString();
            ketQuaThi = Double.parseDouble(tableDanhSachHocVienDaChon.getValueAt(0,2).toString());
            rowIndexDSHV = 0;
            this.btnXoaDonActionPerformed(evt);
        }
    }//GEN-LAST:event_btnXoaTatCaActionPerformed
    
    private void btnXoaDonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnXoaDonActionPerformed
        DefaultTableModel defaultTableModel = (DefaultTableModel) tableDanhSachHocVien.getModel();

        //kiểm tra xem đã chọn dòng chưa.
        if (maHocVien == null) {
            JOptionPane.showMessageDialog(this, "Vui lòng chọn học viên trước khi xóa !");
            return;
        }
        //kiểm tra xem học viên  đã được add chưa
        if (tableDanhSachHocVien.getRowCount() != 0) {
            for (int i = 0; i < tableDanhSachHocVien.getRowCount(); i++) {
                if (tableDanhSachHocVien.getValueAt(i, 0).toString().equals(maHocVien)) {
                    JOptionPane.showMessageDialog(this, "Học vên này đã tồn tại !");
                    return;
                }
            }
        }

        //add thêm học viên vào table phòng thi
        Vector row = new Vector();
        row.add(maHocVien);
        row.add(tenHocVien);
        row.add(ketQuaThi);
        defaultTableModel.addRow(row);
        //xóa dòng bên danh sách học viên
        if (tableDanhSachHocVienDaChon.getRowCount() >= rowIndexDSHV) {
            ((DefaultTableModel) tableDanhSachHocVienDaChon.getModel()).removeRow(rowIndexDSHV);
        }
        maHocVien = null;
        tenHocVien = null;
        ketQuaThi = null;
    }//GEN-LAST:event_btnXoaDonActionPerformed

    private void btnThemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThemActionPerformed
        try {
            tableDanhSachHocVien.setModel(new HocVienController().GetListListHocVienTheoDiemYeuCau(Double.parseDouble(txtDiemDauVao.getText())));
        } catch (Exception ex) {
            Logger.getLogger(FrameXepLop.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnThemActionPerformed

    private void txtSoLuongActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtSoLuongActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtSoLuongActionPerformed

    private void tableDanhSachHocVienMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tableDanhSachHocVienMouseClicked
        JTable jTable1 = (JTable) evt.getSource();

        rowIndexDSHV = jTable1.getSelectedRow();

        //lưu lại các giá trị để dùng add qua bảng khác
        if (jTable1.getValueAt(0, 0) == null) {
            return;
        }
        maHocVien = jTable1.getValueAt(rowIndexDSHV, 0).toString();
        tenHocVien = jTable1.getValueAt(rowIndexDSHV, 1).toString();
        ketQuaThi = Double.parseDouble(jTable1.getValueAt(rowIndexDSHV, 2).toString());
    }//GEN-LAST:event_tableDanhSachHocVienMouseClicked

    private void tableDanhSachHocVienDaChonMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tableDanhSachHocVienDaChonMouseClicked
        tableHVDaCHon = (JTable) evt.getSource();

        rowIndexDSHV = tableHVDaCHon.getSelectedRow();

        //lưu lại các giá trị để dùng add qua bảng khác
        if (tableHVDaCHon.getValueAt(0, 0) == null) {
            return;
        }
        maHocVien = tableHVDaCHon.getValueAt(rowIndexDSHV, 0).toString();
        tenHocVien = tableHVDaCHon.getValueAt(rowIndexDSHV, 1).toString();
        ketQuaThi = Double.parseDouble(tableHVDaCHon.getValueAt(rowIndexDSHV, 2).toString());
    }//GEN-LAST:event_tableDanhSachHocVienDaChonMouseClicked

    private void btnLuuActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLuuActionPerformed
//        try {
            
//            Boolean result = false;
//            
//            int row1 = tablePhong.getRowCount();
//            int row2 = tableOldPhong.getRowCount();
//
//            Vector<String> lstStr = new Vector<>();
//
//            for (int k = 0; k < row2; k++) {
//                lstStr.add(tableOldPhong.getValueAt(k, 0).toString());
//            }
//
//            for (int i = 0; i < row1; i++) {
//                if (!lstStr.contains(tablePhong.getValueAt(i, 0))) {
//                    try {
//                        DanhSachThiDTO danhSachThiDTO = new DanhSachThiDTO();
//                        danhSachThiDTO.setMahocvien(tablePhong.getValueAt(i, 0).toString());
//                        danhSachThiDTO.setMakythi(getKeyKythi(comboBoxTenKyThi.getSelectedItem().toString()));
//
//                        //them
//                        result = new XepLopThiThuController().InsertHocVien(danhSachThiDTO);
//                    } catch (Exception ex) {
//                        Logger.getLogger(FrameQuanTri.class.getName()).log(Level.SEVERE, null, ex);
//                        return;
//                    }
//                }
//            }
//            //        //them
//            //        for (int i = 0; i < tablePhong.getRowCount(); i++) {
//                //            try {
//                    //                DanhSachThiDTO danhSachThiDTO = new DanhSachThiDTO();
//                    //                danhSachThiDTO.setMahocvien(tablePhong.getValueAt(i, 0).toString());
//                    //                danhSachThiDTO.setMakythi(getKeyKythi(comboBoxTenKyThi.getSelectedItem().toString()));
//                    //
//                    //                //them
//                    //                new XepLopThiThuController().InsertHocVien(danhSachThiDTO);
//                    //            } catch (Exception ex) {
//                    //                Logger.getLogger(FrameXepLopThiThu.class.getName()).log(Level.SEVERE, null, ex);
//                    //            }
//                //        }
//
//            //xoa
//            //xóa quyền
//            Vector<String> lstStr1 = new Vector<>();
//            for (int k = 0; k < row1; k++) {
//                lstStr1.add(tablePhong.getValueAt(k, 0).toString());
//            }
//            if (row1 < row2) {
//                for (int j = 0; j < row2; j++) {
//                    if (!lstStr1.contains(tableOldPhong.getValueAt(j, 0))) {
//                        try {
//                            DanhSachThiDTO danhSachThiDTO = new DanhSachThiDTO();
//                            danhSachThiDTO.setMahocvien(tableOldPhong.getValueAt(j, 0).toString());
//                            danhSachThiDTO.setMakythi(getKeyKythi(comboBoxTenKyThi.getSelectedItem().toString()));
//
//                            //them
//                            result = new XepLopThiThuBO().DeleteHocVien(danhSachThiDTO);
//                        } catch (Exception ex) {
//                            Logger.getLogger(FrameQuanTri.class.getName()).log(Level.SEVERE, null, ex);
//                            return;
//                        }
//                    }
//                }
//            }
//            if (result) {
//                JOptionPane.showMessageDialog(this, "Lưu thành công !");
//            }
//            //câp nhật giá trị lại bản cũ
//            txtTenPhongChange();
//        } catch (Exception ex) {
//            Logger.getLogger(FrameXepLopThiThu.class.getName()).log(Level.SEVERE, null, ex);
//        }
    }//GEN-LAST:event_btnLuuActionPerformed

    private void btnDongActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnDongActionPerformed
       this.dispose();
    }//GEN-LAST:event_btnDongActionPerformed

    private void btnXepLopActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnXepLopActionPerformed
        FrameXepLopThiThu frameKetQuaThiThu = new FrameXepLopThiThu();

        if (StoreSave.isExsting(frameKetQuaThiThu)) {
            StoreSave.desktop.add(frameKetQuaThiThu);
            frameKetQuaThiThu.setLocation(300, 60);
            frameKetQuaThiThu.show();
        }
    }//GEN-LAST:event_btnXepLopActionPerformed

     //Khởi Tạo các frameInternal
    private void InitFrameInternal(JInternalFrame jInternalFrame)
    {         
           StoreSave.desktop.add(jInternalFrame);

              try {
                     jInternalFrame.setMaximum(true);
                 } catch (PropertyVetoException ex) {
                     Logger.getLogger(FrameMain.class.getName()).log(Level.SEVERE, null, ex);
                 }
               jInternalFrame.show();
    }
    
    
    private String getKey(HashMap hashMap, String value) {
        for (Object s : hashMap.keySet()) {
            if (hashMap.get(s).equals(value)) {
                return (String) s;
            }
        }
        return null;
    }
    
    public JTable GetTableDSHVDaChon(){
        return tableDanhSachHocVienDaChon;
    }
    public javax.swing.JComboBox GetcomboBoxMaLop(){
        return comboBoxMaLop;
    }
    
    public javax.swing.JTextField GettxtTenLop(){
        return txtTenLop;
    }
    public JTable tableHVDaCHon;
    private int rowIndexDSHV;
    private String maHocVien;
    private String tenHocVien;
    private Double ketQuaThi;
    private HashMap hashMapTenLop;
    private FrameChiTietXepLop frameChiTietXepLop;
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnChTiet;
    private javax.swing.JButton btnChonDon;
    private javax.swing.JButton btnChonTatCa;
    private javax.swing.JButton btnDong;
    private javax.swing.JButton btnLuu;
    private javax.swing.JButton btnThem;
    private javax.swing.JButton btnXepLop;
    private javax.swing.JButton btnXoaDon;
    private javax.swing.JButton btnXoaTatCa;
    private javax.swing.JComboBox comboBoxMaLop;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JLabel lblChuongTrinhHoc;
    private javax.swing.JLabel lblDiemDauVao;
    private javax.swing.JLabel lblGiangVien;
    private javax.swing.JLabel lblKhoaHoc;
    private javax.swing.JLabel lblMaLop;
    private javax.swing.JLabel lblPhong;
    private javax.swing.JLabel lblSoLuong;
    private javax.swing.JLabel lblTenLop;
    private javax.swing.JPanel panelChucNang;
    private javax.swing.JPanel panelXepLop;
    private javax.swing.JTable tableDanhSachHocVien;
    private javax.swing.JTable tableDanhSachHocVienDaChon;
    private javax.swing.JTextField txtChuongTrinhHoc;
    private javax.swing.JTextField txtDiemDauVao;
    private javax.swing.JTextField txtGiangVien;
    private javax.swing.JTextField txtKhoaHoc;
    private javax.swing.JTextField txtPhong;
    private javax.swing.JTextField txtSoLuong;
    private javax.swing.JTextField txtTenLop;
    // End of variables declaration//GEN-END:variables
}
